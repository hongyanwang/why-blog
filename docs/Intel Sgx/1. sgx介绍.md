## SGX介绍

2013年，Intel推出SGX(software guard extensions)指令集扩展, 旨在以硬件安全为强制性保障，不依赖于固件和软件的安全状态，提供用户空间的可信执行环境，通过一组新的指令集扩展与访问控制机制，实现不同程序间的隔离运行，保障用户关键代码和数据的机密性与完整性不受恶意软件的破坏。

SGX的可信计算基(trusted computing base, 简称TCB)仅包括硬件, 避免了基于软件的TCB自身存在软件安全漏洞与威胁的缺陷, 极大地提升了系统安全保障。

SGX可保障运行时的可信执行环境, 恶意代码无法访问与篡改其他程序运行时的保护内容。基于指令集的扩展与独立的认证方式, 使得应用程序可以灵活调用这一安全功能并进行验证。

### SGX优势

1、通过内存加密技术保护程序运行态的安全, 使得通过内存泄漏攻击获取关键信息的难度增大;

2、将系统的可信计算基缩小到CPU, 相比以往将整个操作系统或特权软件(如hypervisor等)视为可信计算基, 可以避免更多的系统攻击带来的危害

3、支持虚拟化技术、容器技术, 可用性更强.

### SGX不足

1、由于enclave处于用户态, 其自身无法执行系统调用, 需要与不可信区域进行交互(运行库的支持有限, 接口的安全性)。在执行系统调用前需要退出enclave, 执行完成后将结果返回到enclave中, 增大了安全风险和系统开销;

2、Enclave中的数据和处理过程, 如果依赖于外部数据, 则存在一定的安全隐患.例如:通过一些不合法输入, 可以发起对可信区的缓冲区溢出攻击, 这些攻击可能会改变可信区中程序的执行流程、获取可信区中的敏感信息;

3、GX本身无法抵御侧信道攻击;

4、SGX提供的enclave可使用内存太小, 当程序数量和规模增大时, 需要换进换出页面.为了保证安全性, 需要对页面进行完整性和机密性保障, 导致系统开销大;

5、使用SGX提供的enclave时需要对程序进行改造, 当程序规模大时, 带来的编程成本高.

### 服务开启

开启sgx服务要满足：

1、保证CPU支持sgx功能

2、在BIOS开启sgx功能

3、安装driver、psw和sdk，参见官方安装包